#' dC/dt for first order linear decay model
#'
#' @description The rate change of a first order linear decay model.
#'
#' @param t numeric for current time point
#' @param y array with current carbon stock
#' @param parms named vector with turnover times or a list of the format specified in \code{publishedParameters}
#' @param tauStr string defining the regexp flagging the turnover times in par
#' @param transStr string defining the regexp flagging the transfer propotions in par
#' @param envSensitivity function dependent on time (t) that returns either a scalor or a matrix that is multiplied to the decomposition function to provide scaling for enviromental conditions.
#' @param ... variables to be passed to the envSensitivity function defined above
#' @param verbose boolean for debuging statements
#'
#' @return rate change of first order linear decay model
#' @export
#' @import assertthat
dC.firstOrderModel <- function(t, y, parms, tauStr='tau', transStr='A', envSensitivity=function(t){return(1)}, verbose=FALSE, ...){
  if(verbose){cat('y:\n'); print(y)}
  if(verbose){cat('parms:\n'); print(parms)}
  Kmatrix <- makeDecompMatrix(parms, tauStr=tauStr, transStr=transStr, verbose=verbose)*envSensitivity(t=t, ...)
  if(verbose){cat('K:\n'); print(Kmatrix)}
  assert_that(dim(Kmatrix)[1] == length(y))
  dim(y) <- c(dim(Kmatrix)[1], 1)
  if(verbose){cat('y:\n'); print(y)}
  ans <- as.numeric(Kmatrix %*% y)
  names(ans) <- sprintf('C%d', 1:length(ans))
  return(list(ans))
}